{% extends 'customer/base.html' %}
{% load static %}

{% block link_block %}
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link rel="stylesheet" href="{% static 'customer/place_order.css' %}">
<link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">

{% endblock %}

{% block body_content %}
<div class="container mt-4">
    <h1 class="mb-4 text-center" style="color: var(--primary-color);">Confirm Your Order</h1>
    
    <div class="card">
        <div class="card-body">
            <h5 class="card-title mb-4">Order Details</h5>
            <div class="order-info">
                {% if payment %}
                <h6>Payment method: <small>{{payment.payment_category }}</small></h6>
                <h6>Transaction Id: <small>{{payment.transaction_id }}</small></h6>
                {% else %}
                <h6>Payment method: <small>Cash on delivery</small></h6>
                {% endif %}
                <h6>Order Created time: <small>{{order.created_at}}</small></h6>
            </div>
            <div class="table-container">
                <div class="row mb-3 table-header py-2 d-none d-md-flex">
                    <div class="col-md-3">Product</div>
                    <div class="col-md-1">Quantity</div>
                    <div class="col-md-2">Product Offer</div>
                    <div class="col-md-2">Unit Category Offer</div>
                    <div class="col-md-2">Unit Coupon Offer</div>
                    <div class="col-md-1">Unit Price</div>
                    <div class="col-md-1 text-end">Total</div>
                </div>
                {% for product in order_products %}
                <div class="row mb-3 py-2 border-bottom align-items-center">
                    <div class="col-md-3 mb-2 mb-md-0">
                        <div class="product-name">{{product.product.product_name}}</div>
                        <div class="product-details d-md-none">Qty: {{product.quantity}} x {{product.product.price}}</div>
                    </div>
                    <div class="col-md-1 d-none d-md-block">{{product.quantity}}</div>
                    <div class="col-md-2 d-none d-md-block">{{product.product_offer}}</div>
                    <div class="col-md-2 d-none d-md-block">{{product.cat_offer}}</div>
                    <div class="col-md-2 d-none d-md-block">{{product.coupon_price}}</div>
                    <div class="col-md-1 d-none d-md-block">{{product.product.price}}-Rs/</div>
                    <div class="col-md-1 text-end">{{product.total_amount}}-Rs/</div>
                </div>
                {% endfor %}
                <div class="row total-row py-2">
                    <div class="col-6 col-md-11 text-end">Total (including shipping(50/RS)):</div>
                    <div class="col-6 col-md-1 text-end">{{total_amount.total|add:50}}-Rs/</div>
                </div>
            </div>
        </div>
    </div> 

    <div class="mt-4 btn-container">
        <a href="{% url 'customer:invoice' order.id %}" class="btn btn-outline-secondary">
            <i class="fas fa-print me-2"></i>Invoice
        </a>
        <a href="{% url 'customer:shop' 0 %}" class="btn btn-confirm">
            <i class="fas fa-arrow-left me-2"></i>Back to Shop
        </a>
    </div>
</div>

<br>
<br>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
<!-- Toastify Messages -->
{% if messages %}
{% for msg in messages %}
<script>
    Toastify({
        text: "{{ msg }}",
        className: "info",
        style: {
            background: "linear-gradient(to right, var(--primary-color), var(--secondary-color))",
        }
    }).showToast();
</script>
{% endfor %}
{% endif %}

{% endblock %}